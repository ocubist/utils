import { DetectorFunction, Transmuter, TransmuterFunction } from "./types";

export const craftErrorTransmuter = <T = any>(
  detectorFunction: DetectorFunction,
  transmuterFunction: TransmuterFunction<T>
): Transmuter<T> => {
  const newTransmuter: Transmuter<T> = {
    detect: detectorFunction,
    transmute: transmuterFunction,
    execute(err) {
      if (this.detect(err)) {
        return this.transmute(err as T);
      }
      return err;
    },
  };

  return newTransmuter;
};
