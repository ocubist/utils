import { useErrorAlchemy } from "@ocubist/error-alchemy";

import { validateUUID } from "./validateUUID";

const { craftMysticError } = useErrorAlchemy("utils-uuid", "assertUUID");

export const AssertUUIDFailedError = craftMysticError({
  name: "AssertUUIDFailedError",
  cause: "UUID-Validation failed",
  errorCode: "DATA_INTEGRITY_VIOLATION",
});

export const assertUUID = (uuid: string): asserts uuid is string => {
  if (!validateUUID(uuid)) {
    throw new AssertUUIDFailedError({
      message: `The provided value is not a valid UUID: ${uuid}`,
      payload: { uuid },
    });
  }
};
